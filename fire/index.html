<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fire Animation</title>
  <style>
    html, body { height: 100%; margin: 0; background: #181c20; overflow: hidden; }
    canvas { display: block; width: 100vw; height: 100vh; }
  </style>
</head>
<body>
<canvas id="fire-canvas"></canvas>
<script>
const canvas = document.getElementById('fire-canvas');
const ctx = canvas.getContext('2d');
let w = window.innerWidth, h = window.innerHeight;
canvas.width = w;
canvas.height = h;
let fireWidth = w, fireHeight = h;
let firePixels = [];
function resizeFire() {
  w = window.innerWidth;
  h = window.innerHeight;
  canvas.width = w;
  canvas.height = h;
  fireWidth = w;
  fireHeight = h;
  firePixels = new Array(fireWidth * fireHeight).fill(0);
  createFireSource();
}
window.addEventListener('resize', resizeFire);

function createFireSource() {
  const sourceRows = Math.max(4, Math.floor(fireHeight * 0.08));
  for (let y = fireHeight - sourceRows; y < fireHeight; y++) {
    for (let x = 0; x < fireWidth; x++) {
      firePixels[y * fireWidth + x] = 36;
    }
  }
}
function updateFire() {
  for (let y = 1; y < fireHeight; y++) {
    for (let x = 0; x < fireWidth; x++) {
      const src = y * fireWidth + x;
      const below = src + fireWidth;
      if (below >= fireWidth * fireHeight) continue;
      const decay = Math.floor(Math.random() * 3);
      const newVal = firePixels[below] - decay;
      firePixels[src - decay >= 0 ? src - decay : 0] = newVal > 0 ? newVal : 0;
    }
  }
}
function renderFire() {
  const img = ctx.createImageData(fireWidth, fireHeight);
  for (let i = 0; i < firePixels.length; i++) {
    const val = firePixels[i];
    const color = firePalette[val];
    img.data[i * 4 + 0] = color[0];
    img.data[i * 4 + 1] = color[1];
    img.data[i * 4 + 2] = color[2];
    img.data[i * 4 + 3] = color[3];
  }
  ctx.putImageData(img, 0, 0);
}
const firePalette = [];
for (let i = 0; i <= 36; i++) {
  let r = i < 18 ? i * 14 : 255;
  let g = i < 18 ? 0 : Math.min(255, (i - 18) * 14);
  let b = 0;
  let a = Math.min(255, i * 7);
  firePalette[i] = [r, g, b, a];
}
function loop() {
  createFireSource(); // continuously refresh the fire source
  updateFire();
  renderFire();
  requestAnimationFrame(loop);
}
resizeFire();
loop();
</script>
</body>
</html>
